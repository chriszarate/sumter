(function(){function e(){return window.getSelection?""+window.getSelection():document.getSelection?""+document.getSelection():document.selection?document.selection.createRange().text:""}function o(e,o){for(var n=e.split(/\s+/),t=0;n.length>t;t++)for(var i=0;r.config.regexes.length>i;i++){o[i]===void 0&&(o[i]=[]);for(var c=0,s=!0;s&&r.config.regexes[i].pos.length>c;c++)if(r.config.regexes[i].pos[c].test(n[t])){o[i].push(parseFloat(n[t].replace(/[^0-9\.]/g,""))),s=!1;break}for(var u=0;s&&r.config.regexes[i].neg.length>u;u++)if(r.config.regexes[i].neg[u].test(n[t])){o[i].push(0-parseFloat(n[t].replace(/[^0-9\.]/g,"")));break}}return o}function n(e){return Math.round(e*r.config.rounder)/r.config.rounder}function t(e){for(var o=String.fromCharCode(160),t=0,i=[],c=0;e.length>t;t++){var s=e[t].length;if(s){for(var u=0,f=0;s>u;u++)f+=e[t][u];i.push(r.config.regexes[t].showBefore+n(f)+r.config.regexes[t].showAfter),c+=f}}var g=i.join(o+" + "+o);return i.length>1&&(g+=o+" = "+o+n(c)),g||r.config.title}var r={config:{title:"Sumter",regexes:[{showBefore:"$",showAfter:"",pos:[/^\$\.?[0-9][0-9,\.]*$/],neg:[/^\(\$\.?[0-9][0-9,\.]*\)$/,/^[\-–]\$\.?[0-9][0-9,\.]*$/]},{showBefore:"£",showAfter:"",pos:[/^£\.?[0-9][0-9,\.]*$/],neg:[/^\(£\.?[0-9][0-9,\.]*\)$/,/^[\-–]£\.?[0-9][0-9,\.]*$/]},{showBefore:"€",showAfter:"",pos:[/^€\.?[0-9][0-9,\.]*$/],neg:[/^\(€\.?[0-9][0-9,\.]*\)$/,/^[\-–]€\.?[0-9][0-9,\.]*$/]},{showBefore:"",showAfter:"¥",pos:[/^\.?[0-9][0-9,\.]*¥[\.,]?$/,/^¥\.?[0-9][0-9,\.]*$/],neg:[/^\(\.?[0-9][0-9,\.]*¥[\.,]?\)$/,/^[\-–]\.?[0-9][0-9,\.]*¥[\.,]?$/,/^\(¥\.?[0-9][0-9,\.]*\)$/,/^[\-–]¥\.?[0-9][0-9,\.]*$/]},{showBefore:"",showAfter:"",pos:[/^\.?[0-9][0-9,\.]*$/],neg:[/^\(\.?[0-9][0-9,\.]+\)$/,/^[\-–]\.?[0-9][0-9,\.]+$/]}],round:2,styles:["position:fixed;","top:0;","right:20px;","padding:5px 10px;","color:#333;","background-color:#ff0;","font-family:Helvetica,Arial,sans-serif;","font-weight:bold;","font-size:16px;","opacity:0.9;","z-index:9999;"]},selection:""};r.hud=document.createTextNode(r.config.title);var i=document.createElement("div"),c=document.createAttribute("style");c.value=r.config.styles.join(""),i.appendChild(r.hud),i.setAttributeNode(c),document.body.appendChild(i);for(var s=0,u="1";r.config.round>s;s++)u+="0";r.config.rounder=parseInt(u,10);var f=function(){var n=e();""!==n?n!==r.selection&&(r.hud.nodeValue=r.total=t(o(n,[])),r.selection=n+""):r.total!==r.config.title&&(r.hud.nodeValue=r.total=r.config.title)};document.onmouseup=function(){document.onmousemove=null,window.setTimeout(f,100)},document.onmousedown=function(){document.onmousemove=f},document.onkeydown=f,document.onkeyup=f,document.ontouchstart=function(){document.ontouchstart=null,window.setInterval(f,100)},f()})();