(function(){function e(){return window.getSelection?""+window.getSelection():document.getSelection?""+document.getSelection():document.selection?document.selection.createRange().text:""}function o(e,o){for(var t=e.split(/\s+/),n=0;t.length>n;n++)for(var i=0;r.config.regexes.length>i;i++){o[i]===void 0&&(o[i]=[]);for(var c=0,s=!0;s&&r.config.regexes[i].pos.length>c;c++)if(r.config.regexes[i].pos[c].test(t[n])){o[i].push(parseFloat(t[n].replace(/[^0-9\.]/g,""))),s=!1;break}for(var u=0;s&&r.config.regexes[i].neg.length>u;u++)if(r.config.regexes[i].neg[u].test(t[n])){o[i].push(0-parseFloat(t[n].replace(/[^0-9\.]/g,"")));break}}return o}function t(e){return Math.round(e*r.config.rounder)/u}function n(e){for(var o=String.fromCharCode(160),n=0,i=[],c=0;e.length>n;n++){var s=e[n].length;if(s){for(var u=0,f=0;s>u;u++)f+=e[n][u];i.push(r.config.regexes[n].showBefore+t(f)+r.config.regexes[n].showAfter),c+=f}}var d=i.join(o+" + "+o);return i.length>1&&(d+=o+" = "+o+t(c)),d||r.config.title}var r={config:{title:"Sumter",regexes:[{showBefore:"$",showAfter:"",pos:[/^\$\.?[0-9][0-9,\.]*$/],neg:[/^\(\$\.?[0-9][0-9,\.]*\)$/,/^[\-–]\$\.?[0-9][0-9,\.]*$/]},{showBefore:"£",showAfter:"",pos:[/^£\.?[0-9][0-9,\.]*$/],neg:[/^\(£\.?[0-9][0-9,\.]*\)$/,/^[\-–]£\.?[0-9][0-9,\.]*$/]},{showBefore:"€",showAfter:"",pos:[/^€\.?[0-9][0-9,\.]*$/],neg:[/^\(€\.?[0-9][0-9,\.]*\)$/,/^[\-–]€\.?[0-9][0-9,\.]*$/]},{showBefore:"",showAfter:"¥",pos:[/^\.?[0-9][0-9,\.]*¥[\.,]?$/,/^¥\.?[0-9][0-9,\.]*$/],neg:[/^\(\.?[0-9][0-9,\.]*¥[\.,]?\)$/,/^[\-–]\.?[0-9][0-9,\.]*¥[\.,]?$/,/^\(¥\.?[0-9][0-9,\.]*\)$/,/^[\-–]¥\.?[0-9][0-9,\.]*$/]},{showBefore:"",showAfter:"",pos:[/^\.?[0-9][0-9,\.]*$/],neg:[/^\(\.?[0-9][0-9,\.]+\)$/,/^[\-–]\.?[0-9][0-9,\.]+$/]}],round:2,styles:["position:fixed;","top:0;","right:20px;","padding:5px 10px;","color:#333;","background-color:#ff0;","font-family:Helvetica,Arial,sans-serif;","font-weight:bold;","font-size:16px;","opacity:0.9;","z-index:9999;"]},selection:""};r.hud=document.createTextNode(r.config.title);var i=document.createElement("div"),c=document.createAttribute("style");c.value=r.config.styles.join(""),i.appendChild(r.hud),i.setAttributeNode(c),document.body.appendChild(i);for(var s=0,u="1";r.config.round>s;s++)u+="0";r.config.rounder=parseInt(u,10);var f=function(){var t=e();return""!==t?(t!==r.selection&&(r.hud.nodeValue=r.total=n(o(t,[])),r.selection=t+""),!1):(r.total!==r.config.title&&(r.hud.nodeValue=r.total=r.config.title),void 0)};document.onmouseup=function(){document.onmousemove=null,window.setTimeout(f,100)},document.onmousedown=function(){document.onmousemove=f},document.onkeydown=f,document.onkeyup=f,document.ontouchstart=function(){document.ontouchstart=null,window.setInterval(f,100)}})();