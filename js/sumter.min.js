(function(){function e(){return window.getSelection?window.getSelection():document.getSelection?document.getSelection():document.selection?document.selection.createRange().text:""}function o(e){function o(e){var t=e.nodeValue;e==r&&e==s&&e!==n?(t&&g.push(t.substring(i,f)),c=u=!0):e==r?(t&&g.push(t.substring(i)),c=!0):e==s?(t&&g.push(t.substring(0,f)),u=!0):3==e.nodeType&&t&&c&&!u&&!/^\s*$/.test(t)&&g.push(t);for(var d=0,l=e.childNodes.length;!u&&l>d;++d)e!==a&&o(e.childNodes[d])}var t=e.getRangeAt(0),n=t.commonAncestorContainer,r=t.startContainer,s=t.endContainer,i=t.startOffset,f=t.endOffset,c=!1,u=!1,g=[];return o(n),g}function t(e,o){for(var t=0;e.length>t;t++)o=n(e[t],o);return o}function n(e,o){for(var t=e.split(/\s+/),n=0;t.length>n;n++)for(var r=0;c.config.regexes.length>r;r++){o[r]===void 0&&(o[r]=[]);for(var s=0,i=!0;i&&c.config.regexes[r].pos.length>s;s++)if(c.config.regexes[r].pos[s].test(t[n])){o[r].push(parseFloat(t[n].replace(/[^0-9\.]/g,""))),i=!1;break}for(var f=0;i&&c.config.regexes[r].neg.length>f;f++)if(c.config.regexes[r].neg[f].test(t[n])){o[r].push(0-parseFloat(t[n].replace(/[^0-9\.]/g,"")));break}}return o}function r(e){return"type"in e&&"Range"===e.type}function s(e,o){return e.type!==o.type||e.focusNode!==o.focusNode||e.focusOffset!==o.focusOffset}function i(e){return Math.round(e*c.config.rounder)/d}function f(e){for(var o=String.fromCharCode(160),t=0,n=[],r=0;e.length>t;t++){var s=e[t].length;if(s){for(var f=0,u=0;s>f;f++)u+=e[t][f];n.push(c.config.regexes[t].showBefore+i(u)+c.config.regexes[t].showAfter),r+=u}}var a=n.join(o+" + "+o);return n.length>1&&(a+=o+" = "+o+i(r)),a||c.config.title}var c={config:{title:"Sumter",regexes:[{showBefore:"$",showAfter:"",pos:[/^\$\.?[0-9][0-9,\.]*$/],neg:[/^\(\$\.?[0-9][0-9,\.]*\)$/,/^[\-–]\$\.?[0-9][0-9,\.]*$/]},{showBefore:"£",showAfter:"",pos:[/^£\.?[0-9][0-9,\.]*$/],neg:[/^\(£\.?[0-9][0-9,\.]*\)$/,/^[\-–]£\.?[0-9][0-9,\.]*$/]},{showBefore:"€",showAfter:"",pos:[/^€\.?[0-9][0-9,\.]*$/],neg:[/^\(€\.?[0-9][0-9,\.]*\)$/,/^[\-–]€\.?[0-9][0-9,\.]*$/]},{showBefore:"",showAfter:"¥",pos:[/^\.?[0-9][0-9,\.]*¥[\.,]?$/,/^¥\.?[0-9][0-9,\.]*$/],neg:[/^\(\.?[0-9][0-9,\.]*¥[\.,]?\)$/,/^[\-–]\.?[0-9][0-9,\.]*¥[\.,]?$/,/^\(¥\.?[0-9][0-9,\.]*\)$/,/^[\-–]¥\.?[0-9][0-9,\.]*$/]},{showBefore:"",showAfter:"",pos:[/^\.?[0-9][0-9,\.]*$/],neg:[/^\(\.?[0-9][0-9,\.]+\)$/,/^[\-–]\.?[0-9][0-9,\.]+$/]}],round:2,styles:["position: fixed;","top: 0;","right: 20px;","padding: 5px 10px;","color: #333;","background-color: #ff0;","font-family: Helvetica, Arial, sans-serif;","font-weight: bold;","font-size: 16px;","opacity: 0.9;","z-index: 9999;"]},selection:{},totals:""},u=document.createAttribute("style");u.value=c.config.styles.join("");var a=document.createElement("div");a.setAttributeNode(u),a.appendChild(document.createTextNode(c.config.title)),document.body.appendChild(a);for(var g=0,d="1";c.config.round>g;g++)d+="0";c.config.rounder=parseInt(d,10);var l=function(){var i=e();switch(typeof i){case"object":if(r(i))return s(i,c.selection)&&(a.innerHTML=c.total=f(t(o(i),[])),c.selection={type:i.type,focusNode:i.focusNode,focusOffset:i.focusOffset}),!1;break;case"string":if(""!==i)return i!==c.selection&&(a.innerHTML=c.total=f(n(i,[])),c.selection=i+""),!1}c.total!==c.config.title&&(a.innerHTML=c.total=c.config.title)};document.onmouseup=function(){document.onmousemove=function(){},window.setTimeout(l,100)},document.onmousedown=function(){document.onmousemove=l},document.onkeydown=l,document.onkeyup=l})();